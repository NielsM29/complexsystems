set.seed(29)
library(ggplot2)
library(tseries)
library(ecp)
#Loading dataset produced by NetLogo and selecting right timeframe
df_1 <- read.csv('wolf_sheep_grass_unstable.csv', skip = 23, col.names = c('', 'time', 'sheep', 'wolves', 'grass'))
df_1[,1] <- NULL
df_1 <- df_1[23000:28000,]
#Plotting the selected timeframe in the dataset
ggplot(data = df_1, aes(x = time)) +
scale_colour_hue() +
geom_line(aes(y = sheep, color = 'Sheep')) +
geom_line(aes(y = wolves, color = 'Wolves')) +
geom_line(aes(y = grass, color = 'Grass')) +
xlab('Time') +
ylab('Number') +
ggtitle('Regime shift in predator-prey dataset')
#Creation variables for change point analysis (CPA)
list <- c('sheep', 'wolves', 'grass')
e.out <- list()
df.e <- df_1[1,]
df.e[,1] <- NULL
df.e[1,] <- rep(NA, 3)
#Creation variables for change point analysis (CPA)
list <- c('sheep', 'wolves', 'grass')
e.out <- list()
df.e <- df_1[1,]
df.e[,1] <- NULL
df.e[1,] <- rep(NA, 3)
df_2 <- data.frame(rep(NA, 4999))
df_2$detrend_sheep <- NA
df_2$detrend_wolves <- NA
df_2$detrend_grass <- NA
df_2[,1] <- NULL
df_2$detrend_sheep <- diff(x = df_1$sheep, lag = 1, differences = 2)
df_2$detrend_wolves <- diff(x = df_1$wolves, lag = 1, differences = 2)
df_2$detrend_grass <- diff(x = df_1$grass, lag = 1, differences = 2)
colnames(df_2) <- c('Detrended Sheep Values', 'Detrended Wolves Values', 'Detrended Grass Values')
ggplot(data = df_2, aes(x = 1:4999, y = `Detrended Sheep Values`)) +
geom_line() +
xlab('Time') +
ylab('Value') +
ggtitle('Detrended Sheep Plot')
ggplot(data = df_2, aes(x = 1:4999, y = `Detrended Wolves Values`)) +
geom_line() +
xlab('Time') +
ylab('Value') +
ggtitle('Detrended Wolves Plot')
ggplot(data = df_2, aes(x = 1:4999, y = `Detrended Grass Values`)) +
geom_line() +
xlab('Time') +
ylab('Value') +
ggtitle('Detrended Grass Plot')
